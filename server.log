
> stacklens-ai-platform@1.0.0 dev:server
> cross-env NODE_ENV=development node --import tsx --no-warnings apps/api/src/index.ts

[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ—‚ï¸ backup and recover secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: âœ… audit secrets and track compliance: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ”„ add secrets lifecycle management: https://dotenvx.com/ops
[JiraIntegrationService] Configuration check:
          - JIRA_HOST: not set
          - JIRA_DOMAIN: set
          - JIRA_PROJECT_KEY: set
          - JIRA_EMAIL: set
          - JIRA_USER_EMAIL: not set
          - JIRA_API_TOKEN: set (hidden)
          - Resolved host: https://stacklens.atlassian.net
          - Configured: true
ğŸš€ RAG: Vector database initialized
ğŸ”„ RAG: Starting knowledge base population...
{"level":"WARN","timestamp":"2025-12-15T18:22:15.836Z","logger":"kafkajs","message":"KafkaJS v2.0.0 switched default partitioner. To retain the same partitioning behavior as in previous versions, create the producer with the option \"createPartitioner: Partitioners.LegacyPartitioner\". See the migration guide at https://kafka.js.org/docs/migration-guide-v2.0.0#producer-new-default-partitioner for details. Silence this warning by setting the environment variable \"KAFKAJS_NO_PARTITIONER_WARNING=1\""}
Setting up SQLite database...
âœ… SQLite database initialized successfully
ğŸ”„ Starting server initialization...
âœ… Database tables initialized
Starting LogWatcher service for real-time monitoring...
ğŸ“ Watching directories: /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/data
[LogWatcherService] Started watching 1 file(s)
âœ… LogWatcher service started successfully
â³ Waiting for RAG initialization to complete...
ğŸ“š RAG: Indexing 50 resolved error patterns...
ğŸ”„ RAG: Creating patterns (skipping embeddings for speed)...
ğŸ”„ RAG: Indexing 50 patterns in vector database...
ğŸ”„ RAG: Caching frequently accessed patterns...
âœ… RAG: Knowledge base populated with 50 patterns
âœ… RAG initialization complete
âœ… Routes registered successfully
ğŸ”„ Setting up Vite...
ğŸ”„ Indexing existing errors for RAG system...
âš ï¸ Vector DB not initialized, storing patterns locally
âœ… Successfully indexed 808 errors for RAG
âœ… Enhanced RAG Suggestor initialized
ğŸ¯ Enhanced RAG system ready with vector database
ğŸš€ Starting Python vector database service...
âš ï¸ Enhanced vector service not found, using fallback similarity search
âœ… Vector database service initialized
âœ… Vite setup complete
ğŸŒ± Seeding SQLite database...
â„¹ï¸ Database already seeded. Skipping seed process.
11:52:18 PM [express] serving on 0.0.0.0:4000
ğŸ“Š Generating metrics for window 1min. Events: 1, Total Events: 1
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
11:52:20 PM [express] POST /api/analytics/events 201 in 8ms :: {"success":true,"message":"Event recorâ€¦
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
11:52:20 PM [express] POST /api/analytics/events 201 in 2ms :: {"success":true,"message":"Event recorâ€¦
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
11:52:35 PM [express] GET /api/auth/me 200 in 15ms :: {"user":{"id":1,"username":"deepanimators","emaâ€¦
Error fetching gemini credential: SqliteError: no such column: "name" - should this be a string literal in single-quotes?
    at Database.prepare (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/better-sqlite3/lib/methods/wrappers.js:5:21)
    at BetterSQLiteSession.prepareQuery (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/better-sqlite3/session.ts:50:28)
    at BetterSQLiteSession.prepareOneTimeQuery (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/sqlite-core/session.ts:135:15)
    at SQLiteSelectBase._prepare (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/sqlite-core/query-builders/select.ts:865:85)
    at SQLiteSelectBase.all (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/sqlite-core/query-builders/select.ts:884:15)
    at SQLiteSelectBase.execute (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/sqlite-core/query-builders/select.ts:896:15)
    at SQLiteSelectBase.then (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/query-promise.ts:31:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'SQLITE_ERROR'
}
Error fetching google credential: SqliteError: no such column: "name" - should this be a string literal in single-quotes?
    at Database.prepare (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/better-sqlite3/lib/methods/wrappers.js:5:21)
    at BetterSQLiteSession.prepareQuery (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/better-sqlite3/session.ts:50:28)
    at BetterSQLiteSession.prepareOneTimeQuery (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/sqlite-core/session.ts:135:15)
    at SQLiteSelectBase._prepare (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/sqlite-core/query-builders/select.ts:865:85)
    at SQLiteSelectBase.all (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/sqlite-core/query-builders/select.ts:884:15)
    at SQLiteSelectBase.execute (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/sqlite-core/query-builders/select.ts:896:15)
    at SQLiteSelectBase.then (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/node_modules/src/query-promise.ts:31:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'SQLITE_ERROR'
}
11:52:35 PM [express] GET /api/admin/api-settings 304 in 58ms :: {"geminiApiKey":"","webhookUrl":"","â€¦
11:52:35 PM [express] GET /api/admin/ui-settings 304 in 10ms :: {"theme":"light","denseMode":true,"auâ€¦
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
ğŸ“Š Processing analyses for user: 0 found
11:52:35 PM [express] GET /api/analysis/processing 200 in 19ms :: {"history":[],"count":0}
ğŸ“Š Analysis history request: { page: 1, limit: 20, fileIdFilter: null, userId: 1 }
11:52:36 PM [express] GET /api/analysis/history 200 in 23ms :: {"history":[{"id":109,"fileId":118,"fiâ€¦
ğŸ” [DEBUG] Dashboard - Resolution Rate: 130 resolved out of 152473 total = 0.1%
ğŸ” [DEBUG] Total analysis history records: 95
ğŸ” [DEBUG] Sample record fields: [
  'id',              'fileId',
  'userId',          'filename',
  'fileType',        'fileSize',
  'uploadTimestamp', 'analysisTimestamp',
  'errorsDetected',  'anomalies',
  'predictions',     'suggestions',
  'totalErrors',     'criticalErrors',
  'highErrors',      'mediumErrors',
  'lowErrors',       'status',
  'errorMessage',    'aiSuggestions',
  'createdAt',       'processingTime',
  'modelAccuracy',   'progress',
  'currentStep'
]
ğŸ” [DEBUG] Sample modelAccuracy: 0
ğŸ” [DEBUG] Completed analyses with modelAccuracy: 94
11:52:40 PM [express] GET /api/dashboard/stats 200 in 4441ms :: {"totalFiles":97,"totalErrors":152473â€¦
Skipping body parsing for: /api/files
11:52:40 PM [express] GET /api/files 200 in 14ms :: {"files":[{"id":118,"filename":"files-17629355510â€¦
11:52:40 PM [express] GET /api/version 304 in 8ms :: {"version":"0.9.6","releaseDate":"2025-11-29","câ€¦
11:52:41 PM [express] GET /api/errors 200 in 729ms :: {"errors":[{"id":155437,"fileId":118,"storeNumbâ€¦
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
11:52:41 PM [express] GET /api/version 200 in 8ms :: {"version":"0.9.6","releaseDate":"2025-11-29","câ€¦
11:52:41 PM [express] GET /api/stores 200 in 15ms :: [{"id":3,"storeNumber":"BK-10","name":"BKC","locâ€¦
11:52:41 PM [express] GET /api/kiosks 200 in 7ms :: [{"id":24,"kioskNumber":"BK-14959-K1","storeId":1â€¦
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
âš ï¸ RAG initialization timeout (30s), continuing...
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
ğŸ“Š Processing analyses for user: 0 found
11:52:51 PM [express] GET /api/analysis/processing 200 in 10ms :: {"history":[],"count":0}
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
ğŸ“Š Processing analyses for user: 0 found
11:53:01 PM [express] GET /api/analysis/processing 200 in 7ms :: {"history":[],"count":0}
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
ğŸ“Š Analysis history request: { page: 1, limit: 20, fileIdFilter: null, userId: 1 }
11:53:11 PM [express] GET /api/analysis/history 200 in 17ms :: {"history":[{"id":109,"fileId":118,"fiâ€¦
ğŸ“Š Processing analyses for user: 0 found
11:53:11 PM [express] GET /api/analysis/processing 200 in 2ms :: {"history":[],"count":0}
ğŸ§¹ Cleaned up old events. Current count: 2
ğŸ§¹ Cleaned up old events. Current count: 2
ğŸ“Š Generating metrics for window 1min. Events: 2, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
ğŸ“Š Generating metrics for window 1min. Events: 0, Total Events: 2
ğŸ”” Updating alerts. Current active: 0. Latest Metric Error Rate: 0
ğŸ“Š Processing analyses for user: 0 found
11:53:21 PM [express] GET /api/analysis/processing 200 in 8ms :: {"history":[],"count":0}
Skipping body parsing for: /api/files/upload
Skipping body parsing for: /api/files/upload
Failed to fetch store/kiosk details for filename standardization: ReferenceError: require is not defined
    at <anonymous> (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/apps/api/src/routes/main-routes.ts:5087:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
11:53:24 PM [express] POST /api/files/upload 200 in 116ms :: {"files":[{"id":119,"filename":"Carrols_â€¦
Skipping body parsing for: /api/files/119/analyze
11:53:24 PM [express] POST /api/files/119/analyze 200 in 3ms :: {"message":"Analysis already in progrâ€¦
Failed to fetch store/kiosk details for filename standardization: ReferenceError: require is not defined
    at <anonymous> (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/apps/api/src/routes/main-routes.ts:5087:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
11:53:24 PM [express] POST /api/files/upload 200 in 127ms :: {"files":[{"id":120,"filename":"Carrols_â€¦
Skipping body parsing for: /api/files/120/analyze
11:53:24 PM [express] POST /api/files/120/analyze 200 in 9ms :: {"message":"Analysis already in progrâ€¦
Analysis job failed: Error: File not found on disk
    at BackgroundJobProcessor.processAnalysisJob (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/apps/api/src/processors/background-processor.ts:123:15)
node:internal/process/promises:394
    triggerUncaughtException(err, true /* fromPromise */);
    ^

Error: File not found on disk
    at BackgroundJobProcessor.processAnalysisJob (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/apps/api/src/processors/background-processor.ts:123:15)

Node.js v22.17.0
