
> stacklens-ai-platform@1.0.0 test:api
> playwright test tests/api

[dotenv@17.2.3] injecting env (14) from .env -- tip: üóÇÔ∏è backup and recover secrets: https://dotenvx.com/ops
[2m[WebServer] [22m
[2m[WebServer] [22m> stacklens-ai-platform@1.0.0 test:server /Users/deepak/Downloads/Projects/StackLens-AI-Deploy
[2m[WebServer] [22m> cross-env NODE_ENV=test node --import tsx --no-warnings apps/api/src/index.ts
[2m[WebServer] [22m
[2m[WebServer] [22m[dotenv@17.2.3] injecting env (0) from .env -- tip: üîë add access controls to secrets: https://dotenvx.com/ops
[2m[WebServer] [22mü§ñ AI Service initialized with 1 providers: gemini
[2m[WebServer] [22m[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
[2m[WebServer] [22m[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
[2m[WebServer] [22müöÄ RAG: Vector database initialized
[2m[WebServer] [22m{"level":"WARN","timestamp":"2025-11-25T19:23:26.338Z","logger":"kafkajs","message":"KafkaJS v2.0.0 switched default partitioner. To retain the same partitioning behavior as in previous versions, create the producer with the option \"createPartitioner: Partitioners.LegacyPartitioner\". See the migration guide at https://kafka.js.org/docs/migration-guide-v2.0.0#producer-new-default-partitioner for details. Silence this warning by setting the environment variable \"KAFKAJS_NO_PARTITIONER_WARNING=1\""}
[2m[WebServer] [22mSetting up SQLite database...
[2m[WebServer] [22m‚úÖ SQLite database initialized successfully
[2m[WebServer] [22müîÑ Starting server initialization...
[2m[WebServer] [22m‚úÖ Database tables initialized
[2m[WebServer] [22mStarting LogWatcher service for real-time monitoring...
[2m[WebServer] [22müìç Watching directories: /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/data, /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/logs
[2m[WebServer] [22m[LogWatcherService] Started watching 2 file(s)
[2m[WebServer] [22m‚úÖ LogWatcher service started successfully
[2m[WebServer] [22m‚úÖ Routes registered successfully
[2m[WebServer] [22müìö RAG: Indexing 50 resolved error patterns...
[2m[WebServer] [22m‚úÖ RAG: Knowledge base populated with 50 patterns
[2m[WebServer] [22m12:53:27 AM [express] serving on port 4001
[2m[WebServer] [22müîÑ Indexing existing errors for RAG system...
[2m[WebServer] [22m‚ÑπÔ∏è No errors with suggestions found for indexing
[2m[WebServer] [22m‚úÖ Enhanced RAG Suggestor initialized
[2m[WebServer] [22müéØ Enhanced RAG system ready with vector database
[2m[WebServer] [22müöÄ Starting Python vector database service...
[2m[WebServer] [22m‚ö†Ô∏è Enhanced vector service not found, using fallback similarity search
[2m[WebServer] [22m‚úÖ Vector database service initialized

Running 102 tests using 5 workers

[dotenv@17.2.3] injecting env (0) from .env -- tip: üîÑ add secrets lifecycle management: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚úÖ audit secrets and track compliance: https://dotenvx.com/ops
‚úì Auth state file verified
Starting authentication setup...
  ‚úì    1 [setup] ‚Ä∫ tests/auth.setup.ts:135:1 ‚Ä∫ verify auth state (437ms)
Using TEST_FIREBASE_TOKEN for authentication...
[2m[WebServer] [22m‚ö†Ô∏è Token verification failed - likely expired. Attempting to decode without verification for development mode...
[2m[WebServer] [22müëë Granting admin role to test@stacklens.ai
[2m[WebServer] [22m12:53:34 AM [express] POST /api/auth/firebase-signin 200 in 75ms :: {"user":{"id":1,"username":"Test ‚Ä¶
‚úì Token exchange successful
[2m[WebServer] [22m12:53:34 AM [express] GET /api/admin/ui-settings 200 in 8ms :: {"theme":"light","sidebarCollapsed":fa‚Ä¶
[2m[WebServer] [22m12:53:34 AM [express] GET /api/auth/me 200 in 3ms :: {"id":1,"email":"test@stacklens.ai","username":"‚Ä¶
[2m[WebServer] [22m12:53:34 AM [express] GET /api/admin/api-settings 200 in 2ms :: {"geminiApiKey":"AIzaSyAOu2YCkjimtYsv‚Ä¶
‚úì Authentication successful with session token
‚úì Authentication state saved to /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/.auth/user.json
  ‚úì    2 [setup] ‚Ä∫ tests/auth.setup.ts:15:1 ‚Ä∫ authenticate user (2.5s)
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  suppress all logs with { quiet: true }
[dotenv@17.2.3] injecting env (0) from .env -- tip: üîÑ add secrets lifecycle management: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  suppress all logs with { quiet: true }
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  override existing env vars with { override: true }
[2m[WebServer] [22m12:53:37 AM [express] GET /api/auth/me 401 in 0ms :: {"message":"Authentication required"}
[2m[WebServer] [22m12:53:37 AM [express] GET /api/auth/me 200 in 0ms :: {"id":1,"email":"test@stacklens.ai","username":"‚Ä¶
[2m[WebServer] [22müëë Granting admin role to test@stacklens.ai
[2m[WebServer] [22m12:53:37 AM [express] POST /api/auth/firebase-signin 200 in 3ms :: {"user":{"id":1,"username":"Test U‚Ä¶
  ‚úì    4 [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:68:5 ‚Ä∫ Authentication API ‚Ä∫ GET /api/auth/me - should reject unauthenticated request (54ms)
  ‚úì    3 [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:42:5 ‚Ä∫ Authentication API ‚Ä∫ GET /api/auth/me - should return current user (71ms)
  ‚úì    5 [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:11:5 ‚Ä∫ Authentication API ‚Ä∫ POST /api/auth/firebase-signin - should authenticate user (65ms)
[2m[WebServer] [22müëë Granting admin role to test@stacklens.ai
[2m[WebServer] [22m12:53:37 AM [express] POST /api/auth/firebase-verify 200 in 4ms :: {"valid":true,"user":{"id":1,"user‚Ä¶
[2m[WebServer] [22mSkipping body parsing for: /api/upload
[2m[WebServer] [22mPOST /api/upload hit
[2m[WebServer] [22mreq.file: {
[2m[WebServer] [22m  fieldname: [32m'file'[39m,
[2m[WebServer] [22m  originalname: [32m'test-errors.xlsx'[39m,
[2m[WebServer] [22m  encoding: [32m'7bit'[39m,
[2m[WebServer] [22m  mimetype: [32m'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'[39m,
[2m[WebServer] [22m  destination: [32m'uploads/'[39m,
[2m[WebServer] [22m  filename: [32m'file-1764098617140-402537903.xlsx'[39m,
[2m[WebServer] [22m  path: [32m'uploads/file-1764098617140-402537903.xlsx'[39m,
[2m[WebServer] [22m  size: [33m9[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mreq.user: {
[2m[WebServer] [22m  id: [33m1[39m,
[2m[WebServer] [22m  email: [32m'test@stacklens.ai'[39m,
[2m[WebServer] [22m  username: [32m'testuser'[39m,
[2m[WebServer] [22m  role: [32m'admin'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mError uploading file: SqliteError: NOT NULL constraint failed: log_files.file_path
[2m[WebServer] [22m    at PreparedQuery.values [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:156:26[90m)[39m
[2m[WebServer] [22m    at PreparedQuery.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:124:21[90m)[39m
[2m[WebServer] [22m    at QueryPromise.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:396:26[90m)[39m
[2m[WebServer] [22m    at QueryPromise.execute [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:408:40[90m)[39m
[2m[WebServer] [22m    at QueryPromise.then [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/query-promise.ts:31:15[90m)[39m
[2m[WebServer] [22m[90m    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)[39m {
[2m[WebServer] [22m  code: [32m'SQLITE_CONSTRAINT_NOTNULL'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m12:53:37 AM [express] POST /api/upload 500 in 15ms :: {"message":"Failed to upload file"}
[2m[WebServer] [22mSkipping body parsing for: /api/upload
[2m[WebServer] [22mSkipping body parsing for: /api/upload
[2m[WebServer] [22mPOST /api/upload hit
[2m[WebServer] [22mreq.file: {
[2m[WebServer] [22m  fieldname: [32m'file'[39m,
[2m[WebServer] [22m  originalname: [32m'test-errors.csv'[39m,
[2m[WebServer] [22m  encoding: [32m'7bit'[39m,
[2m[WebServer] [22m  mimetype: [32m'text/csv'[39m,
[2m[WebServer] [22m  destination: [32m'uploads/'[39m,
[2m[WebServer] [22m  filename: [32m'file-1764098617155-212162365.csv'[39m,
[2m[WebServer] [22m  path: [32m'uploads/file-1764098617155-212162365.csv'[39m,
[2m[WebServer] [22m  size: [33m33[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mreq.user: {
[2m[WebServer] [22m  id: [33m1[39m,
[2m[WebServer] [22m  email: [32m'test@stacklens.ai'[39m,
[2m[WebServer] [22m  username: [32m'testuser'[39m,
[2m[WebServer] [22m  role: [32m'admin'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m12:53:37 AM [express] POST /api/upload 500 in 8ms :: {"message":"Failed to upload file"}
[2m[WebServer] [22mPOST /api/upload hit
[2m[WebServer] [22mreq.file: {
[2m[WebServer] [22m  fieldname: [32m'file'[39m,
[2m[WebServer] [22m  originalname: [32m'test.pdf'[39m,
[2m[WebServer] [22m  encoding: [32m'7bit'[39m,
[2m[WebServer] [22m  mimetype: [32m'application/pdf'[39m,
[2m[WebServer] [22m  destination: [32m'uploads/'[39m,
[2m[WebServer] [22m  filename: [32m'file-1764098617156-393100048.pdf'[39m,
[2m[WebServer] [22m  path: [32m'uploads/file-1764098617156-393100048.pdf'[39m,
[2m[WebServer] [22m  size: [33m9[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mError uploading file: SqliteError: NOT NULL constraint failed: log_files.file_path
[2m[WebServer] [22m    at PreparedQuery.values [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:156:26[90m)[39m
[2m[WebServer] [22m    at PreparedQuery.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:124:21[90m)[39m
[2m[WebServer] [22m    at QueryPromise.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:396:26[90m)[39m
[2m[WebServer] [22m    at QueryPromise.execute [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:408:40[90m)[39m
[2m[WebServer] [22m    at QueryPromise.then [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/query-promise.ts:31:15[90m)[39m
[2m[WebServer] [22m[90m    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)[39m {
[2m[WebServer] [22m  code: [32m'SQLITE_CONSTRAINT_NOTNULL'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mreq.user: {
[2m[WebServer] [22m  id: [33m1[39m,
[2m[WebServer] [22m  email: [32m'test@stacklens.ai'[39m,
[2m[WebServer] [22m  username: [32m'testuser'[39m,
[2m[WebServer] [22m  role: [32m'admin'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m12:53:37 AM [express] POST /api/upload 400 in 7ms :: {"message":"Invalid file type. Only Excel, CSV, ‚Ä¶
  ‚úò    8 [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:84:5 ‚Ä∫ File Upload API ‚Ä∫ POST /api/upload - should upload Excel file (48ms)
  ‚úì    6 [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:27:5 ‚Ä∫ Authentication API ‚Ä∫ POST /api/auth/firebase-verify - should verify token (97ms)
  ‚úò    9 [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:104:5 ‚Ä∫ File Upload API ‚Ä∫ POST /api/upload - should upload CSV file (40ms)
  ‚úì   10 [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:119:5 ‚Ä∫ File Upload API ‚Ä∫ POST /api/upload - should reject invalid file type (40ms)
[2m[WebServer] [22mToken verification failed: Decoding Firebase ID token failed. Make sure you passed the entire string JWT which represents an ID token. See https://firebase.google.com/docs/auth/admin/verify-id-tokens for details on how to retrieve an ID token.
[2m[WebServer] [22m12:53:37 AM [express] POST /api/auth/firebase-signin 401 in 1ms :: {"message":"Invalid Firebase token‚Ä¶
[2m[WebServer] [22mSkipping body parsing for: /api/upload
[2m[WebServer] [22mPOST /api/upload hit
[2m[WebServer] [22mreq.file: {
[2m[WebServer] [22m  fieldname: [32m'file'[39m,
[2m[WebServer] [22m  originalname: [32m'test.xlsx'[39m,
[2m[WebServer] [22m  encoding: [32m'7bit'[39m,
[2m[WebServer] [22m  mimetype: [32m'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'[39m,
[2m[WebServer] [22m  destination: [32m'uploads/'[39m,
[2m[WebServer] [22m  filename: [32m'file-1764098617201-997907243.xlsx'[39m,
[2m[WebServer] [22m  path: [32m'uploads/file-1764098617201-997907243.xlsx'[39m,
[2m[WebServer] [22m  size: [33m4[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mreq.user: {
[2m[WebServer] [22m  id: [33m1[39m,
[2m[WebServer] [22m  email: [32m'test@stacklens.ai'[39m,
[2m[WebServer] [22m  username: [32m'testuser'[39m,
[2m[WebServer] [22m  role: [32m'admin'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mError uploading file: SqliteError: NOT NULL constraint failed: log_files.file_path
[2m[WebServer] [22m    at PreparedQuery.values [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:156:26[90m)[39m
[2m[WebServer] [22m    at PreparedQuery.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:124:21[90m)[39m
[2m[WebServer] [22m    at QueryPromise.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:396:26[90m)[39m
[2m[WebServer] [22m    at QueryPromise.execute [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:408:40[90m)[39m
[2m[WebServer] [22m    at QueryPromise.then [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/query-promise.ts:31:15[90m)[39m
[2m[WebServer] [22m[90m    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)[39m {
[2m[WebServer] [22m  code: [32m'SQLITE_CONSTRAINT_NOTNULL'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m12:53:37 AM [express] POST /api/upload 500 in 4ms :: {"message":"Failed to upload file"}
[2m[WebServer] [22mSkipping body parsing for: /api/files/undefined
[2m[WebServer] [22m12:53:37 AM [express] GET /api/files/undefined 400 in 1ms :: {"error":"Invalid file ID"}
  ‚úì    7 [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:54:5 ‚Ä∫ Authentication API ‚Ä∫ POST /api/auth/firebase-signin - should reject invalid token (88ms)
  ‚úò   11 [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:165:5 ‚Ä∫ File Upload API ‚Ä∫ GET /api/files/:id - should get file details (43ms)
[2m[WebServer] [22m12:53:37 AM [express] GET /api/errors 200 in 56ms :: {"errors":[{"id":253,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:53:37 AM [express] GET /api/errors 200 in 142ms :: {"errors":[{"id":253,"fileId":null,"storeNumber‚Ä¶
  ‚úì   13 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:13:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should support pagination (140ms)
  ‚úì   12 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:5:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should retrieve all errors (202ms)
[2m[WebServer] [22m12:53:37 AM [express] GET /api/errors 200 in 2ms :: {"errors":[{"id":251,"fileId":null,"storeNumber":‚Ä¶
  ‚úì   14 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:36:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should filter by error type (95ms)
  ‚úì   15 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:47:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should filter by date range (119ms)
[2m[WebServer] [22m12:53:37 AM [express] GET /api/errors 200 in 87ms :: {"errors":[{"id":253,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:53:37 AM [express] GET /api/errors 200 in 148ms :: {"errors":[{"id":248,"fileId":null,"storeNumber‚Ä¶
  ‚úò   16 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:58:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should search by message (226ms)
[2m[WebServer] [22m12:53:37 AM [express] GET /api/errors 200 in 133ms :: {"errors":[{"id":253,"fileId":null,"storeNumber‚Ä¶
  ‚úò   17 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:69:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should filter by resolved status (316ms)
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  suppress all logs with { quiet: true }
[dotenv@17.2.3] injecting env (0) from .env -- tip: üë• sync secrets across teammates & machines: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
[2m[WebServer] [22mSkipping body parsing for: /api/upload
[2m[WebServer] [22mPOST /api/upload hit
[2m[WebServer] [22mreq.file: {
[2m[WebServer] [22m  fieldname: [32m'file'[39m,
[2m[WebServer] [22m  originalname: [32m'list-test.xlsx'[39m,
[2m[WebServer] [22m  encoding: [32m'7bit'[39m,
[2m[WebServer] [22m  mimetype: [32m'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'[39m,
[2m[WebServer] [22m  destination: [32m'uploads/'[39m,
[2m[WebServer] [22m  filename: [32m'file-1764098619580-200330932.xlsx'[39m,
[2m[WebServer] [22m  path: [32m'uploads/file-1764098619580-200330932.xlsx'[39m,
[2m[WebServer] [22m  size: [33m9[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mreq.user: {
[2m[WebServer] [22m  id: [33m1[39m,
[2m[WebServer] [22m  email: [32m'test@stacklens.ai'[39m,
[2m[WebServer] [22m  username: [32m'testuser'[39m,
[2m[WebServer] [22m  role: [32m'admin'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mError uploading file: SqliteError: NOT NULL constraint failed: log_files.file_path
[2m[WebServer] [22m    at PreparedQuery.values [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:156:26[90m)[39m
[2m[WebServer] [22m    at PreparedQuery.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:124:21[90m)[39m
[2m[WebServer] [22m    at QueryPromise.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:396:26[90m)[39m
[2m[WebServer] [22m    at QueryPromise.execute [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:408:40[90m)[39m
[2m[WebServer] [22m    at QueryPromise.then [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/query-promise.ts:31:15[90m)[39m
[2m[WebServer] [22m[90m    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)[39m {
[2m[WebServer] [22m  code: [32m'SQLITE_CONSTRAINT_NOTNULL'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m12:53:39 AM [express] POST /api/upload 500 in 5ms :: {"message":"Failed to upload file"}
[2m[WebServer] [22mSkipping body parsing for: /api/upload
[2m[WebServer] [22mPOST /api/upload hit
[2m[WebServer] [22mreq.file: {
[2m[WebServer] [22m  fieldname: [32m'file'[39m,
[2m[WebServer] [22m  originalname: [32m'test.xlsx'[39m,
[2m[WebServer] [22m  encoding: [32m'7bit'[39m,
[2m[WebServer] [22m  mimetype: [32m'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'[39m,
[2m[WebServer] [22m  destination: [32m'uploads/'[39m,
[2m[WebServer] [22m  filename: [32m'file-1764098619586-828132879.xlsx'[39m,
[2m[WebServer] [22m  path: [32m'uploads/file-1764098619586-828132879.xlsx'[39m,
[2m[WebServer] [22m  size: [33m4[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mreq.user: {
[2m[WebServer] [22m  id: [33m1[39m,
[2m[WebServer] [22m  email: [32m'test@stacklens.ai'[39m,
[2m[WebServer] [22m  username: [32m'testuser'[39m,
[2m[WebServer] [22m  role: [32m'admin'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mError uploading file: SqliteError: NOT NULL constraint failed: log_files.file_path
[2m[WebServer] [22m    at PreparedQuery.values [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:156:26[90m)[39m
[2m[WebServer] [22m    at PreparedQuery.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:124:21[90m)[39m
[2m[WebServer] [22m    at QueryPromise.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:396:26[90m)[39m
[2m[WebServer] [22m    at QueryPromise.execute [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:408:40[90m)[39m
[2m[WebServer] [22m    at QueryPromise.then [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/query-promise.ts:31:15[90m)[39m
[2m[WebServer] [22m[90m    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)[39m {
[2m[WebServer] [22m  code: [32m'SQLITE_CONSTRAINT_NOTNULL'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m12:53:39 AM [express] POST /api/upload 500 in 3ms :: {"message":"Failed to upload file"}
[2m[WebServer] [22mSkipping body parsing for: /api/files
[2m[WebServer] [22m12:53:39 AM [express] GET /api/files 200 in 3ms :: {"files":[{"id":6,"filename":"file-1764098448257-1‚Ä¶
[2m[WebServer] [22mSkipping body parsing for: /api/files/undefined
[2m[WebServer] [22müóëÔ∏è Attempting to delete file with ID: NaN
[2m[WebServer] [22m‚ùå Invalid file ID provided
[2m[WebServer] [22m12:53:39 AM [express] DELETE /api/files/undefined 400 in 1ms :: {"message":"Invalid file ID"}
  ‚úò   18 [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:138:5 ‚Ä∫ File Upload API ‚Ä∫ GET /api/files - should list uploaded files (154ms)
  ‚úò   19 [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:190:5 ‚Ä∫ File Upload API ‚Ä∫ DELETE /api/files/:id - should delete file (215ms)
[2m[WebServer] [22m12:53:39 AM [express] GET /api/errors 200 in 2ms :: {"errors":[],"total":0,"page":1,"limit":20,"total‚Ä¶
  ‚úì   20 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:25:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should filter by severity (103ms)
[2m[WebServer] [22m12:53:39 AM [express] POST /api/errors 400 in 1ms :: {"error":"Missing required fields: message and s‚Ä¶
  ‚úì   21 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:136:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ POST /api/errors ‚Ä∫ should validate required fields (27ms)
[2m[WebServer] [22m12:53:39 AM [express] POST /api/errors 400 in 0ms :: {"error":"Invalid severity"}
  ‚úì   22 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:151:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ POST /api/errors ‚Ä∫ should validate severity values (29ms)
[2m[WebServer] [22m12:53:39 AM [express] POST /api/errors 201 in 3ms :: {"id":264,"fileId":null,"storeNumber":null,"kios‚Ä¶
  ‚úì   23 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:165:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ POST /api/errors ‚Ä∫ should set default values for optional fields (481ms)
[2m[WebServer] [22m12:53:40 AM [express] POST /api/errors 201 in 40ms :: {"id":265,"fileId":null,"storeNumber":null,"kio‚Ä¶
[2m[WebServer] [22m12:53:40 AM [express] GET /api/errors/265 200 in 3ms :: {"id":265,"fileId":null,"storeNumber":null,"k‚Ä¶
  ‚úì   24 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:185:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors/:id ‚Ä∫ should retrieve specific error by ID (392ms)
[2m[WebServer] [22m12:53:41 AM [express] GET /api/errors/99999999 404 in 2ms :: {"error":"Error not found","message":"Er‚Ä¶
  ‚úì   25 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:208:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors/:id ‚Ä∫ should return 404 for non-existent error (142ms)
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
[2m[WebServer] [22m12:53:41 AM [express] GET /api/errors/invalid-id 400 in 1ms :: {"error":"Invalid error ID","message":‚Ä¶
  ‚úì   26 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:213:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors/:id ‚Ä∫ should return 400 for invalid ID format (15ms)
[2m[WebServer] [22m12:53:41 AM [express] POST /api/errors 201 in 1ms :: {"id":266,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:53:41 AM [express] PATCH /api/errors/266 200 in 1ms :: {"id":266,"fileId":null,"storeNumber":null,‚Ä¶
  ‚úì   27 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:220:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ PATCH /api/errors/:id ‚Ä∫ should update error fields (28ms)
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  override existing env vars with { override: true }
[2m[WebServer] [22m12:53:41 AM [express] POST /api/errors 201 in 3ms :: {"id":267,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:53:41 AM [express] PATCH /api/errors/267 400 in 1ms :: {"error":"Invalid severity"}
  ‚úì   29 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:253:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ PATCH /api/errors/:id ‚Ä∫ should validate updated field values (23ms)
[2m[WebServer] [22m12:53:41 AM [express] PATCH /api/errors/99999999 404 in 2ms :: {"error":"Error not found"}
[2m[WebServer] [22m12:53:41 AM [express] GET /api/errors 200 in 3ms :: {"errors":[],"total":0,"page":1,"limit":20,"total‚Ä¶
  ‚úì   30 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:271:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ PATCH /api/errors/:id ‚Ä∫ should return 404 when updating non-existent error (14ms)
  ‚úì   28 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:80:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should filter by store (64ms)
[2m[WebServer] [22m12:53:41 AM [express] POST /api/errors 201 in 2ms :: {"id":268,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:53:41 AM [express] DELETE /api/errors/268 200 in 6ms :: {"message":"Error deleted"}
[2m[WebServer] [22m12:53:41 AM [express] GET /api/errors/268 404 in 1ms :: {"error":"Error not found","message":"Error n‚Ä¶
[2m[WebServer] [22m12:53:41 AM [express] DELETE /api/errors/99999999 404 in 0ms :: {"error":"Error not found"}
  ‚úì   31 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:281:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ DELETE /api/errors/:id ‚Ä∫ should delete error (35ms)
  ‚úì   33 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:304:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ DELETE /api/errors/:id ‚Ä∫ should return 404 when deleting non-existent error (16ms)
[2m[WebServer] [22m12:53:41 AM [express] POST /api/errors/bulk 201 in 4ms :: {"created":3,"ids":[269,270,271]}
  ‚úì   34 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:311:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ POST /api/errors/bulk ‚Ä∫ should create multiple errors in bulk (20ms)
[2m[WebServer] [22m12:53:41 AM [express] POST /api/errors/bulk 400 in 2ms :: {"error":"Validation failed","invalidIndice‚Ä¶
[2m[WebServer] [22m12:53:41 AM [express] GET /api/errors/stats 400 in 0ms :: {"error":"Invalid error ID","message":"Inva‚Ä¶
  ‚úò   36 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:347:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors/stats ‚Ä∫ should retrieve error statistics (68ms)
  ‚úì   35 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:330:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ POST /api/errors/bulk ‚Ä∫ should handle validation errors in bulk creation (124ms)
[2m[WebServer] [22m12:53:41 AM [express] GET /api/errors 200 in 92ms :: {"errors":[{"id":266,"fileId":null,"storeNumber"‚Ä¶
  ‚úì   32 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:91:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should support sorting (180ms)
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  suppress all logs with { quiet: true }
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  enable debug logging with { debug: true }
[2m[WebServer] [22m12:53:41 AM [express] GET /api/errors/stats/by-store 200 in 99ms :: [{"storeNumber":"unknown","total"‚Ä¶
[2m[WebServer] [22m12:53:41 AM [express] POST /api/errors/export 200 in 4ms
  ‚úì   37 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:369:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors/stats ‚Ä∫ should provide statistics by store (292ms)
  ‚úì   38 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:379:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ POST /api/errors/export ‚Ä∫ should export errors as CSV (459ms)
[2m[WebServer] [22m12:53:41 AM [express] POST /api/errors/export 200 in 1ms :: [{"id":1,"message":"Test"}]
  ‚úì   40 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:392:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ POST /api/errors/export ‚Ä∫ should export errors as JSON (161ms)
[2m[WebServer] [22m12:53:41 AM [express] POST /api/errors/export 200 in 14ms
  ‚úì   42 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:405:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ POST /api/errors/export ‚Ä∫ should export errors as Excel (70ms)
[2m[WebServer] [22m12:53:42 AM [express] GET /api/errors 400 in 0ms :: {"error":"Invalid page parameter"}
[2m[WebServer] [22m12:53:42 AM [express] GET /api/stores 200 in 5ms :: [{"id":1,"storeNumber":"STORE-1764097667423","nam‚Ä¶
[2m[WebServer] [22m12:53:42 AM [express] POST /api/errors 201 in 11ms :: {"id":273,"fileId":null,"storeNumber":null,"kio‚Ä¶
[2m[WebServer] [22m12:53:42 AM [express] GET /api/stores 200 in 2ms :: {"stores":[{"id":1,"storeNumber":"STORE-176409766‚Ä¶
  ‚úì   43 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:422:9 ‚Ä∫ API Tests - Store & Kiosk Management ‚Ä∫ GET /api/stores ‚Ä∫ should retrieve all stores (146ms)
  ‚úì   39 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:105:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should handle invalid query parameters gracefully (601ms)
  ‚úì   41 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:115:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ POST /api/errors ‚Ä∫ should create new error (294ms)
[2m[WebServer] [22m12:53:42 AM [express] GET /api/stores 200 in 1ms :: [{"id":1,"storeNumber":"STORE-1764097667423","nam‚Ä¶
  ‚úì   44 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:430:9 ‚Ä∫ API Tests - Store & Kiosk Management ‚Ä∫ GET /api/stores ‚Ä∫ should support pagination for stores (210ms)
  ‚úì   45 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:438:9 ‚Ä∫ API Tests - Store & Kiosk Management ‚Ä∫ GET /api/stores ‚Ä∫ should search stores by name (334ms)
[2m[WebServer] [22m12:53:42 AM [express] POST /api/stores 201 in 4ms :: {"id":25,"storeNumber":"STORE-1764098622521-957"‚Ä¶
[2m[WebServer] [22m12:53:42 AM [express] GET /api/kiosks 200 in 1ms :: []
[2m[WebServer] [22m12:53:42 AM [express] GET /api/kiosks 200 in 0ms :: []
  ‚úì   49 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:489:9 ‚Ä∫ API Tests - Store & Kiosk Management ‚Ä∫ GET /api/kiosks ‚Ä∫ should filter kiosks by store (15ms)
  ‚úì   46 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:446:9 ‚Ä∫ API Tests - Store & Kiosk Management ‚Ä∫ POST /api/stores ‚Ä∫ should create new store (348ms)
[2m[WebServer] [22m12:53:42 AM [express] POST /api/stores 201 in 2ms :: {"id":26,"storeNumber":"STORE-1764098622545-364"‚Ä¶
[2m[WebServer] [22mError creating store: SqliteError: UNIQUE constraint failed: stores.store_number
[2m[WebServer] [22m    at PreparedQuery.values [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:156:26[90m)[39m
[2m[WebServer] [22m    at PreparedQuery.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:124:21[90m)[39m
[2m[WebServer] [22m    at QueryPromise.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:396:26[90m)[39m
[2m[WebServer] [22m    at QueryPromise.execute [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:408:40[90m)[39m
[2m[WebServer] [22m    at QueryPromise.then [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/query-promise.ts:31:15[90m)[39m
[2m[WebServer] [22m[90m    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)[39m {
[2m[WebServer] [22m  code: [32m'SQLITE_CONSTRAINT_UNIQUE'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m12:53:42 AM [express] POST /api/stores 409 in 4ms :: {"message":"Store with this number already exist‚Ä¶
  ‚úì   47 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:463:9 ‚Ä∫ API Tests - Store & Kiosk Management ‚Ä∫ POST /api/stores ‚Ä∫ should prevent duplicate store numbers (228ms)
  ‚úì   48 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:481:9 ‚Ä∫ API Tests - Store & Kiosk Management ‚Ä∫ GET /api/kiosks ‚Ä∫ should retrieve all kiosks (122ms)
[2m[WebServer] [22m12:53:42 AM [express] POST /api/ml/train 200 in 0ms :: {"jobId":"ml-job-1764098622674-3v60mdlq0","sta‚Ä¶
[2m[WebServer] [22m12:53:42 AM [express] POST /api/kiosks 400 in 2ms :: {"error":"Invalid store number - store does not ‚Ä¶
[2m[WebServer] [22m12:53:42 AM [express] POST /api/kiosks 400 in 1ms :: {"error":"Invalid store number - store does not ‚Ä¶
  ‚úì   52 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:535:9 ‚Ä∫ API Tests - ML Training Endpoints ‚Ä∫ POST /api/ml/train ‚Ä∫ should initiate ML training job (37ms)
[2m[WebServer] [22m12:53:42 AM [express] POST /api/ml/train 400 in 0ms :: {"error":"Invalid modelType"}
  ‚úì   51 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:517:9 ‚Ä∫ API Tests - Store & Kiosk Management ‚Ä∫ POST /api/kiosks ‚Ä∫ should validate kiosk belongs to valid store (126ms)
  ‚úò   50 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:501:9 ‚Ä∫ API Tests - Store & Kiosk Management ‚Ä∫ POST /api/kiosks ‚Ä∫ should create new kiosk (51ms)
  ‚úì   53 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:554:9 ‚Ä∫ API Tests - ML Training Endpoints ‚Ä∫ POST /api/ml/train ‚Ä∫ should validate training configuration (29ms)
[2m[WebServer] [22m12:53:42 AM [express] POST /api/ml/predict 200 in 0ms :: {"prediction":{"type":"Runtime","severity":"‚Ä¶
[2m[WebServer] [22m12:53:42 AM [express] POST /api/ml/train 200 in 1ms :: {"jobId":"ml-job-1764098622724-cjjxkdvkg","sta‚Ä¶
[2m[WebServer] [22m12:53:42 AM [express] GET /api/ml/jobs/ml-job-1764098622724-cjjxkdvkg 200 in 1ms :: {"jobId":"ml-job-‚Ä¶
  ‚úì   55 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:594:9 ‚Ä∫ API Tests - ML Training Endpoints ‚Ä∫ POST /api/ml/predict ‚Ä∫ should make prediction with trained model (69ms)
  ‚úì   54 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:568:9 ‚Ä∫ API Tests - ML Training Endpoints ‚Ä∫ GET /api/ml/jobs/:jobId ‚Ä∫ should retrieve training job status (113ms)
[2m[WebServer] [22m12:53:43 AM [express] GET /api/ml/models 200 in 2ms :: [{"id":"model-1","name":"Production Model v1",‚Ä¶
  ‚úì   56 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:623:9 ‚Ä∫ API Tests - ML Training Endpoints ‚Ä∫ GET /api/ml/models ‚Ä∫ should filter models by status (324ms)
[2m[WebServer] [22m12:53:43 AM [express] POST /api/ai/analyze 200 in 1ms :: {"analysis":"Simulated AI analysis for: unkn‚Ä¶
[2m[WebServer] [22m12:53:43 AM [express] POST /api/ai/analyze 200 in 1ms :: {"analysis":"Simulated AI analysis for: unkn‚Ä¶
[2m[WebServer] [22m12:53:43 AM [express] POST /api/ai/suggest 200 in 0ms :: {"suggestions":[{"id":"fix-1","title":"Fix N‚Ä¶
  ‚úì   58 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:655:9 ‚Ä∫ API Tests - AI Analysis Endpoints ‚Ä∫ POST /api/ai/analyze ‚Ä∫ should handle timeout for long-running analysis (64ms)
  ‚úì   57 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:637:9 ‚Ä∫ API Tests - AI Analysis Endpoints ‚Ä∫ POST /api/ai/analyze ‚Ä∫ should analyze error with AI (86ms)
[2m[WebServer] [22mSkipping body parsing for: /api/upload
[2m[WebServer] [22mPOST /api/upload hit
[2m[WebServer] [22mreq.file: {
[2m[WebServer] [22m  fieldname: [32m'file'[39m,
[2m[WebServer] [22m  originalname: [32m'test.xlsx'[39m,
[2m[WebServer] [22m  encoding: [32m'7bit'[39m,
[2m[WebServer] [22m  mimetype: [32m'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'[39m,
[2m[WebServer] [22m  destination: [32m'uploads/'[39m,
[2m[WebServer] [22m  filename: [32m'file-1764098623129-791512434.xlsx'[39m,
[2m[WebServer] [22m  path: [32m'uploads/file-1764098623129-791512434.xlsx'[39m,
[2m[WebServer] [22m  size: [33m18[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mreq.user: {
[2m[WebServer] [22m  id: [33m1[39m,
[2m[WebServer] [22m  email: [32m'test@stacklens.ai'[39m,
[2m[WebServer] [22m  username: [32m'testuser'[39m,
[2m[WebServer] [22m  role: [32m'admin'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mError uploading file: SqliteError: NOT NULL constraint failed: log_files.file_path
[2m[WebServer] [22m    at PreparedQuery.values [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:156:26[90m)[39m
[2m[WebServer] [22m    at PreparedQuery.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:124:21[90m)[39m
[2m[WebServer] [22m    at QueryPromise.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:396:26[90m)[39m
[2m[WebServer] [22m    at QueryPromise.execute [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:408:40[90m)[39m
[2m[WebServer] [22m    at QueryPromise.then [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/query-promise.ts:31:15[90m)[39m
[2m[WebServer] [22m[90m    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)[39m {
[2m[WebServer] [22m  code: [32m'SQLITE_CONSTRAINT_NOTNULL'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m12:53:43 AM [express] POST /api/upload 500 in 13ms :: {"message":"Failed to upload file"}
  ‚úì   59 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:666:9 ‚Ä∫ API Tests - AI Analysis Endpoints ‚Ä∫ POST /api/ai/suggest ‚Ä∫ should provide fix suggestions (61ms)
  ‚úò   61 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:707:9 ‚Ä∫ API Tests - File Upload & Processing ‚Ä∫ POST /api/upload ‚Ä∫ should handle Excel file upload (120ms)
[2m[WebServer] [22m12:53:43 AM [express] POST /api/ai/summarize 200 in 1ms :: {"summary":"Simulated summary of multiple ‚Ä¶
  ‚úì   60 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:685:9 ‚Ä∫ API Tests - AI Analysis Endpoints ‚Ä∫ POST /api/ai/summarize ‚Ä∫ should summarize multiple errors (196ms)
[2m[WebServer] [22mSkipping body parsing for: /api/upload
[2m[WebServer] [22mPOST /api/upload hit
[2m[WebServer] [22mreq.file: {
[2m[WebServer] [22m  fieldname: [32m'file'[39m,
[2m[WebServer] [22m  originalname: [32m'test.csv'[39m,
[2m[WebServer] [22m  encoding: [32m'7bit'[39m,
[2m[WebServer] [22m  mimetype: [32m'text/csv'[39m,
[2m[WebServer] [22m  destination: [32m'uploads/'[39m,
[2m[WebServer] [22m  filename: [32m'file-1764098623343-521147977.csv'[39m,
[2m[WebServer] [22m  path: [32m'uploads/file-1764098623343-521147977.csv'[39m,
[2m[WebServer] [22m  size: [33m4[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mreq.user: {
[2m[WebServer] [22m  id: [33m1[39m,
[2m[WebServer] [22m  email: [32m'test@stacklens.ai'[39m,
[2m[WebServer] [22m  username: [32m'testuser'[39m,
[2m[WebServer] [22m  role: [32m'admin'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mError uploading file: SqliteError: NOT NULL constraint failed: log_files.file_path
[2m[WebServer] [22m    at PreparedQuery.values [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:156:26[90m)[39m
[2m[WebServer] [22m    at PreparedQuery.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/better-sqlite3/session.ts:124:21[90m)[39m
[2m[WebServer] [22m    at QueryPromise.all [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:396:26[90m)[39m
[2m[WebServer] [22m    at QueryPromise.execute [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/sqlite-core/query-builders/insert.ts:408:40[90m)[39m
[2m[WebServer] [22m    at QueryPromise.then [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4msrc[24m/query-promise.ts:31:15[90m)[39m
[2m[WebServer] [22m[90m    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)[39m {
[2m[WebServer] [22m  code: [32m'SQLITE_CONSTRAINT_NOTNULL'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m12:53:43 AM [express] POST /api/upload 500 in 4ms :: {"message":"Failed to upload file"}
[2m[WebServer] [22mSkipping body parsing for: /api/upload
[2m[WebServer] [22m12:53:43 AM [express] GET /api/uploads/undefined 400 in 1ms :: {"message":"Invalid file ID"}
  ‚úò   63 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:760:9 ‚Ä∫ API Tests - File Upload & Processing ‚Ä∫ GET /api/uploads/:fileId ‚Ä∫ should retrieve upload status (37ms)
[2m[WebServer] [22m‚ùå Server error: MulterError: File too large
[2m[WebServer] [22m    at abortWithCode [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mmulter[24m/lib/make-middleware.js:85:22[90m)[39m
[2m[WebServer] [22m    at FileStream.<anonymous> [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mmulter[24m/lib/make-middleware.js:155:11[90m)[39m
[2m[WebServer] [22m[90m    at FileStream.emit (node:events:518:28)[39m
[2m[WebServer] [22m    at SBMH.ssCb [as _cb] [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mbusboy[24m/lib/types/multipart.js:479:32[90m)[39m
[2m[WebServer] [22m    at feed [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mstreamsearch[24m/lib/sbmh.js:248:10[90m)[39m
[2m[WebServer] [22m    at SBMH.push [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mstreamsearch[24m/lib/sbmh.js:104:16[90m)[39m
[2m[WebServer] [22m    at Multipart._write [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mbusboy[24m/lib/types/multipart.js:567:19[90m)[39m
[2m[WebServer] [22m[90m    at writeOrBuffer (node:internal/streams/writable:572:12)[39m
[2m[WebServer] [22m[90m    at _write (node:internal/streams/writable:501:10)[39m
[2m[WebServer] [22m[90m    at Writable.write (node:internal/streams/writable:510:10)[39m {
[2m[WebServer] [22m  code: [32m'LIMIT_FILE_SIZE'[39m,
[2m[WebServer] [22m  field: [32m'file'[39m,
[2m[WebServer] [22m  storageErrors: []
[2m[WebServer] [22m}
[2m[WebServer] [22m12:53:43 AM [express] POST /api/upload 500 in 78ms :: {"message":"File too large"}
  ‚úò   62 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:726:9 ‚Ä∫ API Tests - File Upload & Processing ‚Ä∫ POST /api/upload ‚Ä∫ should reject files exceeding size limit (109ms)
[dotenv@17.2.3] injecting env (0) from .env -- tip: üë• sync secrets across teammates & machines: https://dotenvx.com/ops
[2m[WebServer] [22m12:53:44 AM [express] GET /api/errors/stats 400 in 0ms :: {"error":"Invalid error ID","message":"Inva‚Ä¶
  ‚úò   64 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:359:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors/stats ‚Ä∫ should filter statistics by date range (89ms)
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
[2m[WebServer] [22m12:53:44 AM [express] GET /api/ml/models 200 in 1ms :: [{"id":"model-1","name":"Production Model v1",‚Ä¶
  ‚úì   65 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:615:9 ‚Ä∫ API Tests - ML Training Endpoints ‚Ä∫ GET /api/ml/models ‚Ä∫ should list all trained models (113ms)
[2m[WebServer] [22m12:53:44 AM [express] GET /api/admin/users 401 in 0ms :: {"message":"Authentication required"}
  ‚úì   66 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:831:9 ‚Ä∫ API Tests - Authentication & Authorization ‚Ä∫ GET /api/admin/users ‚Ä∫ should require admin role (33ms)
[2m[WebServer] [22mToken verification failed: Decoding Firebase ID token failed. Make sure you passed the entire string JWT which represents an ID token. See https://firebase.google.com/docs/auth/admin/verify-id-tokens for details on how to retrieve an ID token.
[2m[WebServer] [22m‚úÖ Using mock token for user: test@stacklens.ai
[2m[WebServer] [22müëë Granting admin role to test@stacklens.ai
[2m[WebServer] [22m12:53:44 AM [express] POST /api/auth/firebase-signin 200 in 7ms :: {"user":{"id":1,"username":"Test U‚Ä¶
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
Auth response: {
  user: {
    id: [33m1[39m,
    username: [32m'Test User'[39m,
    email: [32m'test@stacklens.ai'[39m,
    role: [32m'admin'[39m,
    firstName: [32m'Test'[39m,
    lastName: [32m'User'[39m,
    profileImageUrl: [32m'https://example.com/avatar.jpg'[39m,
    department: [1mnull[22m,
    isActive: [33mtrue[39m,
    lastLogin: [32m'2025-11-25T19:23:44.000Z'[39m,
    createdAt: [32m'+057872-01-12T00:20:00.000Z'[39m,
    updatedAt: [32m'+057872-01-12T00:20:00.000Z'[39m
  },
  token: [32m'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTc2NDA5ODYyNCwiZXhwIjoxNzY0MTg1MDI0fQ.kOEkhmbYXRKZ2_E3rAHmZaxzspfPDEp1P4ylO8428OY'[39m,
  provider: [32m'firebase'[39m
}
[2m[WebServer] [22m12:53:45 AM [express] GET /api/admin/users 200 in 2ms :: [{"id":1,"username":"Test User","email":"tes‚Ä¶
  ‚úì   67 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:838:9 ‚Ä∫ API Tests - Authentication & Authorization ‚Ä∫ GET /api/admin/users ‚Ä∫ should allow access with admin token (299ms)
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  override existing env vars with { override: true }
[dotenv@17.2.3] injecting env (0) from .env -- tip: üîÑ add secrets lifecycle management: https://dotenvx.com/ops
[2m[WebServer] [22m12:53:45 AM [express] POST /api/errors 400 in 1ms :: {"error":"Missing required fields: message and s‚Ä¶
  ‚úì   68 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:871:5 ‚Ä∫ API Tests - Request Validation ‚Ä∫ should reject requests with invalid Content-Type (268ms)
[2m[WebServer] [22m‚ùå Server error: SyntaxError: Unexpected token '"', ""{invalid json}"" is not valid JSON
[2m[WebServer] [22m    at JSON.parse (<anonymous>)
[2m[WebServer] [22m    at createStrictSyntaxError [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mbody-parser[24m/lib/types/json.js:169:10[90m)[39m
[2m[WebServer] [22m    at parse [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mbody-parser[24m/lib/types/json.js:86:15[90m)[39m
[2m[WebServer] [22m    at [90m/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mbody-parser[24m/lib/read.js:128:18
[2m[WebServer] [22m[90m    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)[39m
[2m[WebServer] [22m    at invokeCallback [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mraw-body[24m/index.js:238:16[90m)[39m
[2m[WebServer] [22m    at done [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mraw-body[24m/index.js:227:7[90m)[39m
[2m[WebServer] [22m    at IncomingMessage.onEnd [90m(/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/[39mnode_modules/[4mraw-body[24m/index.js:287:7[90m)[39m
[2m[WebServer] [22m[90m    at IncomingMessage.emit (node:events:518:28)[39m
[2m[WebServer] [22m[90m    at endReadableNT (node:internal/streams/readable:1698:12)[39m {
[2m[WebServer] [22m  expose: [33mtrue[39m,
[2m[WebServer] [22m  statusCode: [33m400[39m,
[2m[WebServer] [22m  status: [33m400[39m,
[2m[WebServer] [22m  body: [32m'"{invalid json}"'[39m,
[2m[WebServer] [22m  type: [32m'entity.parse.failed'[39m
[2m[WebServer] [22m}
  ‚úì   69 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:882:5 ‚Ä∫ API Tests - Request Validation ‚Ä∫ should validate JSON syntax (89ms)
[2m[WebServer] [22m12:53:45 AM [express] POST /api/errors 201 in 23ms :: {"id":274,"fileId":null,"storeNumber":null,"kio‚Ä¶
[2m[WebServer] [22mSkipping body parsing for: /api/upload
  ‚úò   73 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:893:5 ‚Ä∫ API Tests - Request Validation ‚Ä∫ should enforce maximum payload size (47ms)
[2m[WebServer] [22mPOST /api/upload hit
[2m[WebServer] [22mreq.file: {
[2m[WebServer] [22m  fieldname: [32m'file'[39m,
[2m[WebServer] [22m  originalname: [32m'test.exe'[39m,
[2m[WebServer] [22m  encoding: [32m'7bit'[39m,
[2m[WebServer] [22m  mimetype: [32m'application/x-msdownload'[39m,
[2m[WebServer] [22m  destination: [32m'uploads/'[39m,
[2m[WebServer] [22m  filename: [32m'file-1764098625692-952781522.exe'[39m,
[2m[WebServer] [22m  path: [32m'uploads/file-1764098625692-952781522.exe'[39m,
[2m[WebServer] [22m  size: [33m12[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mreq.user: {
[2m[WebServer] [22m  id: [33m1[39m,
[2m[WebServer] [22m  email: [32m'test@stacklens.ai'[39m,
[2m[WebServer] [22m  username: [32m'testuser'[39m,
[2m[WebServer] [22m  role: [32m'admin'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m12:53:45 AM [express] POST /api/upload 400 in 8ms :: {"message":"Invalid file type. Only Excel, CSV, ‚Ä¶
[2m[WebServer] [22mToken verification failed: Decoding Firebase ID token failed. Make sure you passed the entire string JWT which represents an ID token. See https://firebase.google.com/docs/auth/admin/verify-id-tokens for details on how to retrieve an ID token.
[2m[WebServer] [22m12:53:45 AM [express] POST /api/auth/firebase 401 in 1ms :: {"message":"Invalid Firebase token"}
[2m[WebServer] [22müëë Granting admin role to test@stacklens.ai
[2m[WebServer] [22m12:53:45 AM [express] POST /api/auth/firebase 200 in 4ms :: {"userId":1,"user":{"id":1,"username":"Te‚Ä¶
  ‚úì   70 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:799:9 ‚Ä∫ API Tests - Authentication & Authorization ‚Ä∫ POST /api/auth/firebase ‚Ä∫ should reject invalid token (93ms)
  ‚úì   71 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:742:9 ‚Ä∫ API Tests - File Upload & Processing ‚Ä∫ POST /api/upload ‚Ä∫ should reject unsupported file types (112ms)
  ‚úò   72 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:785:9 ‚Ä∫ API Tests - Authentication & Authorization ‚Ä∫ POST /api/auth/firebase ‚Ä∫ should authenticate with valid Firebase token (106ms)
[2m[WebServer] [22m12:53:45 AM [express] POST /api/errors 400 in 0ms :: {"error":"Missing required fields: message and s‚Ä¶
  ‚úì   75 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:918:5 ‚Ä∫ API Tests - Request Validation ‚Ä∫ should handle missing request body (29ms)
[2m[WebServer] [22m12:53:46 AM [express] GET /api/errors 200 in 174ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
  ‚úò   74 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:924:5 ‚Ä∫ API Tests - Request Validation ‚Ä∫ should validate URL parameter formats (249ms)
  ‚úì   76 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:941:5 ‚Ä∫ API Tests - Response Format Validation ‚Ä∫ should return proper Content-Type headers (199ms)
[2m[WebServer] [22m12:53:46 AM [express] GET /api/errors 200 in 129ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:46 AM [express] GET /api/errors/999999 404 in 1ms :: {"error":"Error not found","message":"Erro‚Ä¶
  ‚úì   77 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:959:5 ‚Ä∫ API Tests - Response Format Validation ‚Ä∫ should return consistent error response format (27ms)
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  load multiple .env files with { path: ['.env.local', '.env'] }
[2m[WebServer] [22m12:53:46 AM [express] GET /api/errors 200 in 63ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
  ‚úì   78 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:969:5 ‚Ä∫ API Tests - Response Format Validation ‚Ä∫ should include pagination metadata (87ms)
  ‚úì   79 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:981:5 ‚Ä∫ API Tests - Response Format Validation ‚Ä∫ should return timestamps in ISO format (668ms)
[2m[WebServer] [22m12:53:47 AM [express] GET /api/errors 200 in 620ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22mToken verification failed: Decoding Firebase ID token failed. Make sure you passed the entire string JWT which represents an ID token. See https://firebase.google.com/docs/auth/admin/verify-id-tokens for details on how to retrieve an ID token.
[2m[WebServer] [22m12:53:47 AM [express] POST /api/auth/firebase 401 in 1ms :: {"message":"Invalid Firebase token"}
  ‚úì   81 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:995:5 ‚Ä∫ API Tests - Error Handling ‚Ä∫ should handle database connection errors gracefully (186ms)
[2m[WebServer] [22m12:53:47 AM [express] GET /api/errors 200 in 100ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:47 AM [express] POST /api/auth/logout 404 in 3ms
[2m[WebServer] [22m12:53:47 AM [express] GET /api/nonexistent 404 in 3ms
  ‚úò   80 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:811:9 ‚Ä∫ API Tests - Authentication & Authorization ‚Ä∫ POST /api/auth/logout ‚Ä∫ should logout user (1.0s)
  ‚úì   82 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1003:5 ‚Ä∫ API Tests - Error Handling ‚Ä∫ should return 404 for non-existent routes (15ms)
[2m[WebServer] [22m12:53:47 AM [express] POST /api/errors 400 in 0ms :: {"error":"Missing required fields: message and s‚Ä¶
  ‚úò   83 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1015:5 ‚Ä∫ API Tests - Error Handling ‚Ä∫ should provide helpful error messages (17ms)
[dotenv@17.2.3] injecting env (0) from .env -- tip: üîê prevent building .env in docker: https://dotenvx.com/prebuild
[dotenv@17.2.3] injecting env (0) from .env -- tip: üîÑ add secrets lifecycle management: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  suppress all logs with { quiet: true }
[2m[WebServer] [22m12:53:47 AM [express] GET /api/errors 200 in 123ms :: {"errors":[],"total":0,"page":1,"limit":20,"tot‚Ä¶
  ‚úì   84 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:907:5 ‚Ä∫ API Tests - Request Validation ‚Ä∫ should validate required headers (313ms)
  ‚úì   85 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:930:5 ‚Ä∫ API Tests - Request Validation ‚Ä∫ should handle special characters in query params (227ms)
[2m[WebServer] [22m12:53:48 AM [express] GET /api/errors 200 in 212ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:49 AM [express] GET /api/errors 200 in 1226ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
  ‚úì   87 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1057:5 ‚Ä∫ API Tests - Rate Limiting ‚Ä∫ should include rate limit headers (1.5s)
  ‚úì   86 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:948:5 ‚Ä∫ API Tests - Response Format Validation ‚Ä∫ should include CORS headers (1.6s)
[2m[WebServer] [22m12:53:49 AM [express] GET /api/errors 200 in 1237ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  enable debug logging with { debug: true }
[dotenv@17.2.3] injecting env (0) from .env -- tip: üîê prevent committing .env to code: https://dotenvx.com/precommit
[2m[WebServer] [22m12:53:50 AM [express] GET /api/errors 200 in 174ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
  ‚úì   90 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1093:5 ‚Ä∫ API Tests - Pagination Edge Cases ‚Ä∫ should handle page=0 (349ms)
[2m[WebServer] [22m12:53:51 AM [express] GET /api/errors 200 in 2245ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:53:51 AM [express] GET /api/errors 400 in 1ms :: {"error":"Invalid page parameter"}
  ‚úì   93 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1100:5 ‚Ä∫ API Tests - Pagination Edge Cases ‚Ä∫ should handle negative page numbers (1.4s)
[2m[WebServer] [22m12:53:52 AM [express] GET /api/errors 200 in 1752ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:53:52 AM [express] GET /api/errors 200 in 298ms :: {"errors":[],"total":261,"page":999999,"limit":‚Ä¶
  ‚úì   94 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1106:5 ‚Ä∫ API Tests - Pagination Edge Cases ‚Ä∫ should handle excessive page numbers (527ms)
[2m[WebServer] [22m12:53:53 AM [express] GET /api/errors 200 in 151ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
  ‚úò   95 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1116:5 ‚Ä∫ API Tests - Pagination Edge Cases ‚Ä∫ should handle limit=0 (727ms)
[2m[WebServer] [22m12:53:53 AM [express] GET /api/errors 200 in 2109ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:53:53 AM [express] GET /api/errors 200 in 3475ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:53:53 AM [express] GET /api/errors 200 in 1414ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:53:54 AM [express] GET /api/errors 200 in 1737ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:53:54 AM [express] GET /api/errors 200 in 1327ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:53:54 AM [express] GET /api/errors 200 in 410ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:54 AM [express] GET /api/errors 200 in 808ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:54 AM [express] GET /api/errors 200 in 345ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  override existing env vars with { override: true }
[2m[WebServer] [22m12:53:55 AM [express] GET /api/errors 200 in 827ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:55 AM [express] GET /api/errors 200 in 962ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:55 AM [express] GET /api/errors 200 in 925ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:55 AM [express] GET /api/errors 200 in 607ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:56 AM [express] GET /api/errors 200 in 363ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:56 AM [express] GET /api/errors 200 in 408ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:56 AM [express] GET /api/errors 200 in 249ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:56 AM [express] GET /api/errors 200 in 422ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:57 AM [express] GET /api/errors 200 in 1001ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:53:57 AM [express] GET /api/errors 200 in 865ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
  ‚úò   88 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1041:5 ‚Ä∫ API Tests - Rate Limiting ‚Ä∫ should implement rate limiting (9.4s)
  ‚úò   89 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1073:5 ‚Ä∫ API Tests - Rate Limiting ‚Ä∫ should reset rate limits after time window (8.3s)
[2m[WebServer] [22m12:53:58 AM [express] GET /api/errors 200 in 1195ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:53:58 AM [express] GET /api/errors 200 in 949ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:58 AM [express] GET /api/errors 200 in 1780ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:53:58 AM [express] GET /api/errors 200 in 1612ms :: {"errors":[{"id":274,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:53:58 AM [express] GET /api/errors 200 in 194ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
  ‚úò   91 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1027:5 ‚Ä∫ API Tests - Error Handling ‚Ä∫ should handle concurrent request failures (8.9s)
[2m[WebServer] [22m12:53:58 AM [express] GET /api/errors 200 in 295ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:58 AM [express] GET /api/errors 200 in 440ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:59 AM [express] GET /api/errors 200 in 372ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:59 AM [express] GET /api/errors 200 in 151ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:53:59 AM [express] GET /api/errors 200 in 722ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  enable debug logging with { debug: true }
[dotenv@17.2.3] injecting env (0) from .env -- tip: üõ†Ô∏è  run anywhere with `dotenvx run -- yourcommand`
[2m[WebServer] [22m12:54:00 AM [express] GET /api/errors 200 in 174ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:00 AM [express] GET /api/errors 200 in 168ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:00 AM [express] GET /api/errors 200 in 335ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  override existing env vars with { override: true }
[2m[WebServer] [22m12:54:01 AM [express] GET /api/errors 200 in 88ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:01 AM [express] GET /api/errors 200 in 352ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:01 AM [express] GET /api/errors 200 in 146ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:01 AM [express] GET /api/errors 200 in 250ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:02 AM [express] GET /api/errors 200 in 641ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:02 AM [express] GET /api/errors 200 in 599ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:02 AM [express] GET /api/errors 200 in 585ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:02 AM [express] GET /api/errors 200 in 96ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:02 AM [express] GET /api/errors 200 in 389ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:03 AM [express] GET /api/errors 200 in 122ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:03 AM [express] GET /api/errors 200 in 264ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:03 AM [express] GET /api/errors 200 in 142ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:03 AM [express] GET /api/errors 200 in 397ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:04 AM [express] GET /api/errors 200 in 99ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:04 AM [express] GET /api/errors 200 in 621ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:04 AM [express] GET /api/errors 200 in 146ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:04 AM [express] GET /api/errors 200 in 331ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:04 AM [express] GET /api/errors 200 in 264ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:04 AM [express] GET /api/errors 200 in 169ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:05 AM [express] GET /api/errors 200 in 157ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:05 AM [express] GET /api/errors 200 in 167ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:05 AM [express] GET /api/errors 200 in 146ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:05 AM [express] GET /api/errors 200 in 165ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:05 AM [express] GET /api/errors 200 in 145ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:05 AM [express] GET /api/errors 200 in 284ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:05 AM [express] GET /api/errors 200 in 79ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:05 AM [express] GET /api/errors 200 in 193ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:05 AM [express] GET /api/errors 200 in 193ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:05 AM [express] GET /api/errors 200 in 138ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:06 AM [express] GET /api/errors 200 in 131ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:06 AM [express] GET /api/errors 200 in 130ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:06 AM [express] GET /api/errors 200 in 130ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:06 AM [express] GET /api/errors 200 in 83ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:06 AM [express] GET /api/errors 200 in 178ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:06 AM [express] GET /api/errors 200 in 316ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:06 AM [express] GET /api/errors 200 in 180ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:07 AM [express] GET /api/errors 200 in 220ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:07 AM [express] GET /api/errors 200 in 201ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:07 AM [express] GET /api/errors 200 in 133ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:07 AM [express] GET /api/errors 200 in 140ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:07 AM [express] GET /api/errors 200 in 140ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:07 AM [express] GET /api/errors 200 in 57ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:07 AM [express] GET /api/errors 200 in 152ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:07 AM [express] GET /api/errors 200 in 143ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:07 AM [express] GET /api/errors 200 in 117ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:08 AM [express] GET /api/errors 200 in 158ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:08 AM [express] GET /api/errors 200 in 120ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:08 AM [express] GET /api/errors 200 in 65ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
  ‚úò   97 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1136:5 ‚Ä∫ API Tests - Concurrent Operations ‚Ä∫ should handle concurrent reads safely (8.1s)
[2m[WebServer] [22m12:54:08 AM [express] GET /api/errors 200 in 75ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:08 AM [express] GET /api/errors 200 in 58ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:08 AM [express] GET /api/errors 200 in 60ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:08 AM [express] GET /api/errors 200 in 76ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:08 AM [express] GET /api/errors 200 in 132ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:09 AM [express] GET /api/errors 200 in 106ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:09 AM [express] GET /api/errors 200 in 73ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[dotenv@17.2.3] injecting env (0) from .env -- tip: üì° add observability to secrets: https://dotenvx.com/ops
[2m[WebServer] [22m12:54:09 AM [express] GET /api/errors 200 in 62ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:09 AM [express] GET /api/errors 200 in 64ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:09 AM [express] GET /api/errors 200 in 61ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:09 AM [express] GET /api/errors 200 in 64ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:09 AM [express] GET /api/errors 200 in 57ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:09 AM [express] GET /api/errors 200 in 57ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:09 AM [express] GET /api/errors 200 in 113ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:09 AM [express] GET /api/errors 200 in 88ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:09 AM [express] GET /api/errors 200 in 84ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:10 AM [express] GET /api/errors 200 in 137ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:10 AM [express] GET /api/errors 200 in 58ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:10 AM [express] GET /api/errors 200 in 56ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:10 AM [express] GET /api/errors 200 in 58ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:10 AM [express] GET /api/errors 200 in 55ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:10 AM [express] GET /api/errors 200 in 86ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:10 AM [express] GET /api/errors 200 in 186ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:11 AM [express] GET /api/errors 200 in 186ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:11 AM [express] GET /api/errors 200 in 60ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:11 AM [express] GET /api/errors 200 in 64ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:11 AM [express] GET /api/errors 200 in 57ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:11 AM [express] GET /api/errors 200 in 55ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:11 AM [express] GET /api/errors 200 in 61ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:11 AM [express] GET /api/errors 200 in 58ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:11 AM [express] GET /api/errors 200 in 53ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:11 AM [express] GET /api/errors 200 in 64ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:11 AM [express] GET /api/errors 200 in 106ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:12 AM [express] GET /api/errors 200 in 133ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:12 AM [express] GET /api/errors 200 in 252ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:12 AM [express] GET /api/errors 200 in 69ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:12 AM [express] GET /api/errors 200 in 71ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:12 AM [express] GET /api/errors 200 in 69ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:12 AM [express] GET /api/errors 200 in 57ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:12 AM [express] GET /api/errors 200 in 68ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:12 AM [express] GET /api/errors 200 in 56ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:12 AM [express] GET /api/errors 200 in 59ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:12 AM [express] GET /api/errors 200 in 62ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:12 AM [express] GET /api/errors 200 in 55ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:13 AM [express] GET /api/errors 200 in 54ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:13 AM [express] GET /api/errors 200 in 138ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:13 AM [express] GET /api/errors 200 in 229ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:13 AM [express] GET /api/errors 200 in 294ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:14 AM [express] GET /api/errors 200 in 71ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:14 AM [express] GET /api/errors 200 in 90ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:14 AM [express] GET /api/errors 200 in 86ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:14 AM [express] GET /api/errors 200 in 81ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:14 AM [express] GET /api/errors 200 in 261ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:14 AM [express] GET /api/errors/999999 404 in 10ms :: {"error":"Error not found","message":"Err‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors 200 in 343ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors/999999 404 in 1ms :: {"error":"Error not found","message":"Erro‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors/999999 404 in 2ms :: {"error":"Error not found","message":"Erro‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors/999999 404 in 1ms :: {"error":"Error not found","message":"Erro‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors/999999 404 in 0ms :: {"error":"Error not found","message":"Erro‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors/not-a-number 400 in 0ms :: {"error":"Invalid error ID","message‚Ä¶
  ‚úì   92 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1009:5 ‚Ä∫ API Tests - Error Handling ‚Ä∫ should handle malformed route parameters (25.2s)
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors 200 in 114ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors 200 in 75ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors 200 in 61ms :: {"errors":[{"id":274,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors 400 in 1ms :: {"error":"Invalid limit parameter"}
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors/999999 404 in 1ms :: {"error":"Error not found","message":"Erro‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors/999999 404 in 0ms :: {"error":"Error not found","message":"Erro‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors/999999 404 in 0ms :: {"error":"Error not found","message":"Erro‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors/999999 404 in 0ms :: {"error":"Error not found","message":"Erro‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors/999999 404 in 0ms :: {"error":"Error not found","message":"Erro‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] GET /api/errors/999999 404 in 0ms :: {"error":"Error not found","message":"Erro‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] POST /api/errors 201 in 1ms :: {"id":275,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] POST /api/errors 201 in 1ms :: {"id":276,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] POST /api/errors 201 in 1ms :: {"id":277,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] POST /api/errors 201 in 1ms :: {"id":278,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] POST /api/errors 201 in 1ms :: {"id":279,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] POST /api/errors 201 in 1ms :: {"id":280,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] POST /api/errors 201 in 1ms :: {"id":281,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] POST /api/errors 201 in 2ms :: {"id":282,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] POST /api/errors 201 in 1ms :: {"id":283,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:54:15 AM [express] POST /api/errors 201 in 1ms :: {"id":284,"fileId":null,"storeNumber":null,"kios‚Ä¶
  ‚úì   96 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1122:5 ‚Ä∫ API Tests - Pagination Edge Cases ‚Ä∫ should enforce maximum limit (20.4s)
  ‚úì   98 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1147:5 ‚Ä∫ API Tests - Concurrent Operations ‚Ä∫ should handle concurrent writes with proper isolation (15.7s)
[2m[WebServer] [22m12:54:16 AM [express] GET /api/errors 200 in 101ms :: {"errors":[{"id":275,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:16 AM [express] GET /api/errors 200 in 238ms :: {"errors":[{"id":275,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:16 AM [express] POST /api/errors 201 in 5ms :: {"id":285,"fileId":null,"storeNumber":null,"kios‚Ä¶
[2m[WebServer] [22m12:54:16 AM [express] GET /api/errors 200 in 604ms :: {"errors":[{"id":274,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:16 AM [express] GET /api/errors 200 in 607ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
  ‚úì  102 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1223:5 ‚Ä∫ API Tests - Cache Control ‚Ä∫ should support If-Modified-Since (1.0s)
[2m[WebServer] [22m12:54:17 AM [express] PUT /api/errors/285 404 in 167ms
[2m[WebServer] [22m12:54:17 AM [express] GET /api/errors 200 in 1433ms :: {"errors":[{"id":275,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:54:17 AM [express] GET /api/errors 200 in 293ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:17 AM [express] GET /api/errors 200 in 405ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:17 AM [express] GET /api/errors 200 in 364ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:18 AM [express] GET /api/errors 200 in 175ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:18 AM [express] GET /api/errors 200 in 362ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:18 AM [express] GET /api/errors 200 in 225ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:18 AM [express] GET /api/errors 200 in 363ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:19 AM [express] GET /api/errors 200 in 148ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:19 AM [express] GET /api/errors 200 in 102ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:19 AM [express] GET /api/errors 200 in 82ms :: {"errors":[{"id":285,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:19 AM [express] GET /api/errors 200 in 137ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:19 AM [express] GET /api/errors 200 in 88ms :: {"errors":[{"id":285,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:19 AM [express] GET /api/errors 200 in 114ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:19 AM [express] GET /api/errors 200 in 111ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
  ‚úì  101 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1208:5 ‚Ä∫ API Tests - Cache Control ‚Ä∫ should respect If-None-Match for conditional requests (4.5s)
[2m[WebServer] [22m12:54:20 AM [express] GET /api/errors 200 in 98ms :: {"errors":[{"id":285,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:20 AM [express] GET /api/errors 200 in 3165ms :: {"errors":[{"id":285,"fileId":null,"storeNumbe‚Ä¶
[2m[WebServer] [22m12:54:20 AM [express] GET /api/errors 200 in 103ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:20 AM [express] GET /api/errors 200 in 168ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:20 AM [express] GET /api/errors 200 in 141ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:21 AM [express] GET /api/errors 200 in 120ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:21 AM [express] GET /api/errors 200 in 84ms :: {"errors":[{"id":285,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:21 AM [express] GET /api/errors 200 in 162ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:21 AM [express] GET /api/errors 200 in 86ms :: {"errors":[{"id":285,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:21 AM [express] GET /api/errors 200 in 67ms :: {"errors":[{"id":285,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:21 AM [express] GET /api/errors 200 in 56ms :: {"errors":[{"id":285,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:21 AM [express] GET /api/errors 200 in 71ms :: {"errors":[{"id":285,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:21 AM [express] GET /api/errors 200 in 57ms :: {"errors":[{"id":285,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:21 AM [express] GET /api/errors 200 in 87ms :: {"errors":[{"id":285,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:22 AM [express] GET /api/errors 200 in 324ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:22 AM [express] GET /api/errors 200 in 366ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:22 AM [express] GET /api/errors 200 in 86ms :: {"errors":[{"id":285,"fileId":null,"storeNumber"‚Ä¶
[2m[WebServer] [22m12:54:23 AM [express] GET /api/errors 200 in 528ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
[2m[WebServer] [22m12:54:23 AM [express] PUT /api/errors/285 404 in 5ms
[2m[WebServer] [22m12:54:23 AM [express] PUT /api/errors/285 404 in 1ms
[2m[WebServer] [22m12:54:23 AM [express] PUT /api/errors/285 404 in 1ms
[2m[WebServer] [22m12:54:23 AM [express] PUT /api/errors/285 404 in 1ms
[2m[WebServer] [22m12:54:23 AM [express] GET /api/errors 200 in 123ms :: {"errors":[{"id":285,"fileId":null,"storeNumber‚Ä¶
  ‚úò   99 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1164:5 ‚Ä∫ API Tests - Concurrent Operations ‚Ä∫ should prevent race conditions on updates (22.3s)
  ‚úì  100 [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1197:5 ‚Ä∫ API Tests - Cache Control ‚Ä∫ should include appropriate cache headers (14.3s)


  1) [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:84:5 ‚Ä∫ File Upload API ‚Ä∫ POST /api/upload - should upload Excel file 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32m200[39m
    Received: [31m500[39m

      94 |         });
      95 |
    > 96 |         expect(response.status()).toBe(200);
         |                                   ^
      97 |
      98 |         const data = await response.json();
      99 |         expect(data).toHaveProperty('fileId');
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/auth-upload.test.ts:96:35

  2) [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:104:5 ‚Ä∫ File Upload API ‚Ä∫ POST /api/upload - should upload CSV file 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32m200[39m
    Received: [31m500[39m

      114 |         });
      115 |
    > 116 |         expect(response.status()).toBe(200);
          |                                   ^
      117 |     });
      118 |
      119 |     test('POST /api/upload - should reject invalid file type', async ({ apiContext }) => {
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/auth-upload.test.ts:116:35

  3) [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:138:5 ‚Ä∫ File Upload API ‚Ä∫ GET /api/files - should list uploaded files 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32mtrue[39m
    Received: [31mfalse[39m

      153 |
      154 |         const data = await response.json();
    > 155 |         expect(Array.isArray(data)).toBe(true);
          |                                     ^
      156 |         expect(data.length).toBeGreaterThan(0);
      157 |
      158 |         if (data.length > 0) {
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/auth-upload.test.ts:155:37

  4) [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:165:5 ‚Ä∫ File Upload API ‚Ä∫ GET /api/files/:id - should get file details 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32m200[39m
    Received: [31m400[39m

      181 |         const response = await apiContext.get(`/api/files/${fileId}`);
      182 |
    > 183 |         expect(response.status()).toBe(200);
          |                                   ^
      184 |
      185 |         const data = await response.json();
      186 |         expect(data).toHaveProperty('id', fileId);
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/auth-upload.test.ts:183:35

  5) [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:190:5 ‚Ä∫ File Upload API ‚Ä∫ DELETE /api/files/:id - should delete file 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32m200[39m
    Received: [31m400[39m

      206 |         const response = await apiContext.delete(`/api/files/${fileId}`);
      207 |
    > 208 |         expect(response.status()).toBe(200);
          |                                   ^
      209 |
      210 |         const data = await response.json();
      211 |         expect(data).toHaveProperty('message', 'File deleted successfully');
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/auth-upload.test.ts:208:35

  6) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:58:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should search by message 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected substring: [32m"database"[39m
    Received string:    [31m"bulk error 2"[39m

      63 |             expect(Array.isArray(data.errors)).toBeTruthy();
      64 |             data.errors.forEach((error: any) => {
    > 65 |                 expect(error.message.toLowerCase()).toContain('database');
         |                                                     ^
      66 |             });
      67 |         });
      68 |
        at forEach (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:65:53)
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:64:25

  7) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:69:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should filter by resolved status 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32mfalse[39m
    Received: [31mtrue[39m

      74 |             expect(Array.isArray(data.errors)).toBeTruthy();
      75 |             data.errors.forEach((error: any) => {
    > 76 |                 expect(error.resolved).toBe(false);
         |                                        ^
      77 |             });
      78 |         });
      79 |
        at forEach (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:76:40)
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:75:25

  8) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:347:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors/stats ‚Ä∫ should retrieve error statistics 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBeTruthy[2m()[22m

    Received: [31mfalse[39m

      348 |             const response = await apiContext.get('/api/errors/stats');
      349 |
    > 350 |             expect(response.ok()).toBeTruthy();
          |                                   ^
      351 |             const stats = await response.json();
      352 |             expect(stats).toHaveProperty('total');
      353 |             expect(stats).toHaveProperty('bySeverity');
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:350:35

  9) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:359:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors/stats ‚Ä∫ should filter statistics by date range 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBeTruthy[2m()[22m

    Received: [31mfalse[39m

      362 |             );
      363 |
    > 364 |             expect(response.ok()).toBeTruthy();
          |                                   ^
      365 |             const stats = await response.json();
      366 |             expect(stats).toHaveProperty('dateRange');
      367 |         });
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:364:35

  10) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:501:9 ‚Ä∫ API Tests - Store & Kiosk Management ‚Ä∫ POST /api/kiosks ‚Ä∫ should create new kiosk 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBeTruthy[2m()[22m

    Received: [31mfalse[39m

      510 |             });
      511 |
    > 512 |             expect(response.ok()).toBeTruthy();
          |                                   ^
      513 |             const created = await response.json();
      514 |             expect(created.kioskNumber).toBe(newKiosk.kioskNumber);
      515 |         });
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:512:35

  11) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:707:9 ‚Ä∫ API Tests - File Upload & Processing ‚Ä∫ POST /api/upload ‚Ä∫ should handle Excel file upload 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBeTruthy[2m()[22m

    Received: [31mfalse[39m

      718 |             });
      719 |
    > 720 |             expect(response.ok()).toBeTruthy();
          |                                   ^
      721 |             const result = await response.json();
      722 |             expect(result).toHaveProperty('fileId');
      723 |             expect(result).toHaveProperty('filename');
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:720:35

  12) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:726:9 ‚Ä∫ API Tests - File Upload & Processing ‚Ä∫ POST /api/upload ‚Ä∫ should reject files exceeding size limit 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32m413[39m
    Received: [31m500[39m

      737 |             });
      738 |
    > 739 |             expect(response.status()).toBe(413); // Payload Too Large
          |                                       ^
      740 |         });
      741 |
      742 |         test('should reject unsupported file types', async ({ apiContext }) => {
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:739:39

  13) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:760:9 ‚Ä∫ API Tests - File Upload & Processing ‚Ä∫ GET /api/uploads/:fileId ‚Ä∫ should retrieve upload status 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBeTruthy[2m()[22m

    Received: [31mfalse[39m

      771 |             // Check status
      772 |             const statusResponse = await apiContext.get(`/api/uploads/${upload.fileId}`);
    > 773 |             expect(statusResponse.ok()).toBeTruthy();
          |                                         ^
      774 |
      775 |             const status = await statusResponse.json();
      776 |             expect(status).toHaveProperty('fileId');
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:773:41

  14) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:785:9 ‚Ä∫ API Tests - Authentication & Authorization ‚Ä∫ POST /api/auth/firebase ‚Ä∫ should authenticate with valid Firebase token 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoHaveProperty[2m([22m[32mpath[39m[2m)[22m

    Expected path: [32m"sessionToken"[39m
    Received path: [31m[][39m

    Received value: [31m{"email": "test@stacklens.ai", "provider": "firebase", "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTc2NDA5ODYyNSwiZXhwIjoxNzY0MTg1MDI1fQ.CrKhs-hTC5M7K46HT6BOs3xZOqanAPUp3_Ru88EfBTA", "user": {"createdAt": "+057872-01-12T00:20:00.000Z", "department": null, "email": "test@stacklens.ai", "firstName": "Test", "id": 1, "isActive": true, "lastLogin": "2025-11-25T19:23:45.000Z", "lastName": "User", "profileImageUrl": "https://example.com/photo.jpg", "role": "admin", "updatedAt": "+057872-01-12T00:20:00.000Z", "username": "Test User"}, "userId": 1}[39m

      794 |             expect(auth).toHaveProperty('userId');
      795 |             expect(auth).toHaveProperty('email');
    > 796 |             expect(auth).toHaveProperty('sessionToken');
          |                          ^
      797 |         });
      798 |
      799 |         test('should reject invalid token', async ({ apiContext }) => {
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:796:26

  15) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:811:9 ‚Ä∫ API Tests - Authentication & Authorization ‚Ä∫ POST /api/auth/logout ‚Ä∫ should logout user 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBeTruthy[2m()[22m

    Received: [31mfalse[39m

      824 |             });
      825 |
    > 826 |             expect(logoutResponse.ok()).toBeTruthy();
          |                                         ^
      827 |         });
      828 |     });
      829 |
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:826:41

  16) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:893:5 ‚Ä∫ API Tests - Request Validation ‚Ä∫ should enforce maximum payload size 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected value: [32m201[39m
    Received array: [31m[413, 400][39m

      902 |         });
      903 |
    > 904 |         expect([413, 400]).toContain(response.status());
          |                            ^
      905 |     });
      906 |
      907 |     test('should validate required headers', async ({ apiContext }) => {
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:904:28

  17) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:924:5 ‚Ä∫ API Tests - Request Validation ‚Ä∫ should validate URL parameter formats 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected value: [32m200[39m
    Received array: [31m[400, 422][39m

      925 |         const response = await apiContext.get('/api/errors?page=invalid');
      926 |
    > 927 |         expect([400, 422]).toContain(response.status());
          |                            ^
      928 |     });
      929 |
      930 |     test('should handle special characters in query params', async ({ apiContext }) => {
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:927:28

  18) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1015:5 ‚Ä∫ API Tests - Error Handling ‚Ä∫ should provide helpful error messages 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBeTruthy[2m()[22m

    Received: [31mundefined[39m

      1021 |         const error = await response.json();
      1022 |
    > 1023 |         expect(error.message).toBeTruthy();
           |                               ^
      1024 |         expect(error.message.length).toBeGreaterThan(0);
      1025 |     });
      1026 |
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1023:31

  19) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1027:5 ‚Ä∫ API Tests - Error Handling ‚Ä∫ should handle concurrent request failures 

    Error: apiRequestContext.get: connect ETIMEDOUT 127.0.0.1:4001
    Call log:
    [2m  - ‚Üí GET http://127.0.0.1:4001/api/errors/999999[22m
    [2m    - user-agent: Playwright/1.57.0 (arm64; macOS 15.6) node/22.17[22m
    [2m    - accept: */*[22m
    [2m    - accept-encoding: gzip,deflate,br[22m
    [2m    - Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTc2NDA5ODYxNCwiZXhwIjoxNzY0MTg1MDE0fQ.XlhVN4Zg4pFyuuuzD_DS7L0ZYAa5ZR3K1ubF4QLpCxM[22m


      1027 |     test('should handle concurrent request failures', async ({ apiContext }) => {
      1028 |         const requests = Array.from({ length: 20 }, () =>
    > 1029 |             apiContext.get('/api/errors/999999')
           |                        ^
      1030 |         );
      1031 |
      1032 |         const responses = await Promise.all(requests);
        at from (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1029:24)
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1028:32

  20) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1041:5 ‚Ä∫ API Tests - Rate Limiting ‚Ä∫ should implement rate limiting 

    Error: apiRequestContext.get: connect ETIMEDOUT 127.0.0.1:4001
    Call log:
    [2m  - ‚Üí GET http://127.0.0.1:4001/api/errors[22m
    [2m    - user-agent: Playwright/1.57.0 (arm64; macOS 15.6) node/22.17[22m
    [2m    - accept: */*[22m
    [2m    - accept-encoding: gzip,deflate,br[22m
    [2m    - Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTc2NDA5ODYxNCwiZXhwIjoxNzY0MTg1MDE0fQ.XlhVN4Zg4pFyuuuzD_DS7L0ZYAa5ZR3K1ubF4QLpCxM[22m
    [2m    - x-test-force-ratelimit: true[22m


      1041 |     test('should implement rate limiting', async ({ apiContext }) => {
      1042 |         const requests = Array.from({ length: 150 }, () =>
    > 1043 |             apiContext.get('/api/errors', {
           |                        ^
      1044 |                 headers: { 'x-test-force-ratelimit': 'true' }
      1045 |             })
      1046 |         );
        at from (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1043:24)
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1042:32

  21) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1073:5 ‚Ä∫ API Tests - Rate Limiting ‚Ä∫ should reset rate limits after time window 

    Error: apiRequestContext.get: connect ETIMEDOUT 127.0.0.1:4001
    Call log:
    [2m  - ‚Üí GET http://127.0.0.1:4001/api/errors[22m
    [2m    - user-agent: Playwright/1.57.0 (arm64; macOS 15.6) node/22.17[22m
    [2m    - accept: */*[22m
    [2m    - accept-encoding: gzip,deflate,br[22m
    [2m    - Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTc2NDA5ODYxNCwiZXhwIjoxNzY0MTg1MDE0fQ.XlhVN4Zg4pFyuuuzD_DS7L0ZYAa5ZR3K1ubF4QLpCxM[22m
    [2m    - x-test-force-ratelimit: true[22m


      1074 |         // Make requests to hit limit
      1075 |         const initialRequests = Array.from({ length: 100 }, () =>
    > 1076 |             apiContext.get('/api/errors', {
           |                        ^
      1077 |                 headers: { 'x-test-force-ratelimit': 'true' }
      1078 |             })
      1079 |         );
        at from (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1076:24)
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1075:39

  22) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1116:5 ‚Ä∫ API Tests - Pagination Edge Cases ‚Ä∫ should handle limit=0 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected value: [32m200[39m
    Received array: [31m[400, 422][39m

      1117 |         const response = await apiContext.get('/api/errors?page=1&limit=0');
      1118 |
    > 1119 |         expect([400, 422]).toContain(response.status());
           |                            ^
      1120 |     });
      1121 |
      1122 |     test('should enforce maximum limit', async ({ apiContext }) => {
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1119:28

  23) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1136:5 ‚Ä∫ API Tests - Concurrent Operations ‚Ä∫ should handle concurrent reads safely 

    Error: apiRequestContext.get: connect ETIMEDOUT 127.0.0.1:4001
    Call log:
    [2m  - ‚Üí GET http://127.0.0.1:4001/api/errors[22m
    [2m    - user-agent: Playwright/1.57.0 (arm64; macOS 15.6) node/22.17[22m
    [2m    - accept: */*[22m
    [2m    - accept-encoding: gzip,deflate,br[22m
    [2m    - Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTc2NDA5ODYxNCwiZXhwIjoxNzY0MTg1MDE0fQ.XlhVN4Zg4pFyuuuzD_DS7L0ZYAa5ZR3K1ubF4QLpCxM[22m


      1136 |     test('should handle concurrent reads safely', async ({ apiContext }) => {
      1137 |         const requests = Array.from({ length: 50 }, () =>
    > 1138 |             apiContext.get('/api/errors')
           |                        ^
      1139 |         );
      1140 |
      1141 |         const responses = await Promise.all(requests);
        at from (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1138:24)
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1137:32

  24) [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1164:5 ‚Ä∫ API Tests - Concurrent Operations ‚Ä∫ should prevent race conditions on updates 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected value: [32m404[39m
    Received array: [31m[200, 409][39m

      1189 |         // All should succeed or have proper conflict handling
      1190 |         responses.forEach(r => {
    > 1191 |             expect([200, 409]).toContain(r.status());
           |                                ^
      1192 |         });
      1193 |     });
      1194 | });
        at forEach (/Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1191:32)
        at /Users/deepak/Downloads/Projects/StackLens-AI-Deploy/tests/api/comprehensive.test.ts:1190:19

  24 failed
    [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:84:5 ‚Ä∫ File Upload API ‚Ä∫ POST /api/upload - should upload Excel file 
    [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:104:5 ‚Ä∫ File Upload API ‚Ä∫ POST /api/upload - should upload CSV file 
    [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:138:5 ‚Ä∫ File Upload API ‚Ä∫ GET /api/files - should list uploaded files 
    [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:165:5 ‚Ä∫ File Upload API ‚Ä∫ GET /api/files/:id - should get file details 
    [api-tests] ‚Ä∫ tests/api/auth-upload.test.ts:190:5 ‚Ä∫ File Upload API ‚Ä∫ DELETE /api/files/:id - should delete file 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:58:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should search by message 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:69:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors ‚Ä∫ should filter by resolved status 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:347:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors/stats ‚Ä∫ should retrieve error statistics 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:359:9 ‚Ä∫ API Tests - Error Management Endpoints ‚Ä∫ GET /api/errors/stats ‚Ä∫ should filter statistics by date range 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:501:9 ‚Ä∫ API Tests - Store & Kiosk Management ‚Ä∫ POST /api/kiosks ‚Ä∫ should create new kiosk 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:707:9 ‚Ä∫ API Tests - File Upload & Processing ‚Ä∫ POST /api/upload ‚Ä∫ should handle Excel file upload 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:726:9 ‚Ä∫ API Tests - File Upload & Processing ‚Ä∫ POST /api/upload ‚Ä∫ should reject files exceeding size limit 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:760:9 ‚Ä∫ API Tests - File Upload & Processing ‚Ä∫ GET /api/uploads/:fileId ‚Ä∫ should retrieve upload status 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:785:9 ‚Ä∫ API Tests - Authentication & Authorization ‚Ä∫ POST /api/auth/firebase ‚Ä∫ should authenticate with valid Firebase token 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:811:9 ‚Ä∫ API Tests - Authentication & Authorization ‚Ä∫ POST /api/auth/logout ‚Ä∫ should logout user 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:893:5 ‚Ä∫ API Tests - Request Validation ‚Ä∫ should enforce maximum payload size 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:924:5 ‚Ä∫ API Tests - Request Validation ‚Ä∫ should validate URL parameter formats 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1015:5 ‚Ä∫ API Tests - Error Handling ‚Ä∫ should provide helpful error messages 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1027:5 ‚Ä∫ API Tests - Error Handling ‚Ä∫ should handle concurrent request failures 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1041:5 ‚Ä∫ API Tests - Rate Limiting ‚Ä∫ should implement rate limiting 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1073:5 ‚Ä∫ API Tests - Rate Limiting ‚Ä∫ should reset rate limits after time window 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1116:5 ‚Ä∫ API Tests - Pagination Edge Cases ‚Ä∫ should handle limit=0 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1136:5 ‚Ä∫ API Tests - Concurrent Operations ‚Ä∫ should handle concurrent reads safely 
    [api-tests] ‚Ä∫ tests/api/comprehensive.test.ts:1164:5 ‚Ä∫ API Tests - Concurrent Operations ‚Ä∫ should prevent race conditions on updates 
  78 passed (59.3s)

[36m  Serving HTML report at http://localhost:61581. Press Ctrl+C to quit.[39m
